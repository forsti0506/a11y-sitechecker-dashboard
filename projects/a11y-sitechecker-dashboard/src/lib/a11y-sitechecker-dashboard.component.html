<mat-toolbar color="primary" role="banner">
  <button mat-icon-button class="example-icon" aria-label="Example icon-button with menu icon">
    <mat-icon>menu</mat-icon>
  </button>
  <h1>A11y-Sitechecker Dashboard</h1>
  <span class="example-spacer"></span>
  <button mat-icon-button class="example-icon favorite-icon" aria-label="Example icon-button with heart icon">
    <mat-icon>favorite</mat-icon>
  </button>
  <button mat-icon-button class="example-icon" aria-label="Example icon-button with share icon">
    <mat-icon>share</mat-icon>
  </button>
</mat-toolbar>
<nav class="m-5" mat-tab-nav-bar>
  <a (click)="(activeLink = site.url) && siteChanged(site)" *ngFor="let site of analyzedSites; trackBy: trackBySiteId"
     [active]="activeLink == site.url"
     mat-tab-link> {{site.url}} </a>
</nav>
<mat-card class="m-5">
  <mat-card-content>
    <mat-button-toggle-group (change)="loadViolationDevelopment($event)" value="{{showChart}}">
      <mat-button-toggle value="general">
        Show general overview
      </mat-button-toggle>
      <mat-button-toggle value="violations">
        Show Violations by url
      </mat-button-toggle>
    </mat-button-toggle-group>
    <div [chart]="chart"></div>
    <mat-tab-group *ngIf="loaded" class="m-5" role="main">
      <mat-tab *ngFor="let urlResult of results.reverse(); let dateTimeIndex = index; trackBy: trackBySiteResult" label="{{urlResult.timestamp | date: 'dd.MM.yy HH:mm'}}">
        <ng-template matTabContent>
          <mat-card class="m-3">
            <mat-card-content>
              <div *ngIf="urlResult.analyzedUrls?.length > 0" class="m-2">Analyzed URLS:
                  <mat-chip-list aria-label="Filter by urls!" multiple>
                  <mat-chip (click)="applyFilter(url)" *ngFor="let url of urlResult.analyzedUrls;" [selected]="this.chosenFilters?.includes(url)"
                            class="m-1">
                    {{url}}
                  </mat-chip></mat-chip-list>
              </div>
              <div class="m-2"><strong>TestEngine:</strong> {{urlResult.testEngine?.name}}
                ({{urlResult.testEngine?.version}})
              </div>
              <div *ngIf="urlResult.testEnvironment" class="m-2">
                <strong>TestEnvironment:</strong> {{urlResult.testEnvironment?.userAgent}}
                (<strong>Width</strong>:
                {{urlResult.testEnvironment?.windowHeight}}, <strong>Height:</strong> {{urlResult.testEnvironment?.windowWidth}},
                <strong>orientation-Angle:</strong> {{urlResult.testEnvironment?.orientationAngle}},
                  <strong>orentiation-Type:</strong> {{urlResult.testEnvironment?.orientationType}})
              </div>
            </mat-card-content>
          </mat-card>
        <mat-card *ngIf="dateTimeIndex !==0 && !serverMode">
          <mat-card-content>
            <b>Detaildaten sind nur für den aktuellsten Eintrag verfügbar!</b>
          </mat-card-content>
        </mat-card>
        <mat-tab-group class="m-5" *ngIf="dateTimeIndex ===0">
          <mat-tab label="violations">
            <ng-template matTabContent>
            <app-single-result [chosenFilter]="chosenFilters" [id]="urlResult.id"
                               [timestamp]="urlResult.timestamp" class="m-5" type="violations"></app-single-result>
            </ng-template>
          </mat-tab>
          <mat-tab label="incomplete">
            <ng-template matTabContent>
            <app-single-result  [chosenFilter]="chosenFilters" [id]="urlResult.id"
                               [timestamp]="urlResult.timestamp" type="incompletes"></app-single-result>
            </ng-template>
          </mat-tab>
          <mat-tab label="inapplicable">
            <ng-template matTabContent>
            <app-single-result  [chosenFilter]="chosenFilters" [id]="urlResult.id"
                               [timestamp]="urlResult.timestamp" type="inapplicables"></app-single-result>
            </ng-template>
          </mat-tab>
          <mat-tab label="passes">
            <ng-template matTabContent>
            <app-single-result [chosenFilter]="chosenFilters" [id]="urlResult.id"
                               [timestamp]="urlResult.timestamp" type="passes"></app-single-result>
            </ng-template>
          </mat-tab>
          <mat-tab label="Tab Order" [disabled]="dateTimeIndex!==0" aria-label="Show Images to see all actual tabable items on the site. Disabled if not the latest one">
            <ng-template matTabContent>
              <mat-expansion-panel *ngFor="let urlImages of urlResult.tabableImages" class="m-2">
                <mat-expansion-panel-header>{{urlImages.url}}</mat-expansion-panel-header>
                <div *ngFor="let image of urlImages.images; let i = index">
                  <b>Image {{i + 1}} of {{urlImages.images.length}}</b><br>
                  <img src="assets/images/{{image}}" alt="Image with clickable Items highlighted">
                </div>
              </mat-expansion-panel>
            </ng-template>
          </mat-tab>

        </mat-tab-group>

        </ng-template>
      </mat-tab>
    </mat-tab-group>

  </mat-card-content>
  <mat-card-footer role="contentinfo">
    Footer
  </mat-card-footer>
</mat-card>
